<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.huacainfo.ace.partyschool.dao.report.Portal">
    <select id="query" resultType="map">
        SELECT
        'eva' id,
        count(DISTINCT(t.classScheduleId))
        VALUE
        FROM
        evaluation_rst_content t
        <if test='classId !=null'>
            inner join student a on t.userId=a.id
            WHERE
            a.classId=#{classId}
        </if>

        UNION ALL
        SELECT
        'teacher' id,
        count(1)
        VALUE
        FROM
        teacher t
        WHERE
        t. STATUS = '1'
        UNION ALL
        SELECT
        'student' id,
        count(1)
        VALUE
        FROM
        student t  WHERE t.STATUS = '1'
        <if test='classId !=null'>
            and t.classId=#{classId}
        </if>
        UNION ALL
        SELECT
        'notice' id,
        count(1)
        VALUE
        FROM
        notice t
        WHERE t.STATUS = '1'
        <if test='classId !=null'>
            and t.classesId=#{classId}
        </if>
    </select>
</mapper>