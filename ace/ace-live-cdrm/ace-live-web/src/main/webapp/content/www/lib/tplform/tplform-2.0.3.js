!function(e){var t=function(e,t){this.formObj="object"==typeof e?e:$("#"+e),this.fieldDict=t,this.init()};t.prototype={init:function(){this.pattern={number:"^\\d+(\\.\\d+)?$",phone:"^1[3-8]\\d{9}$",email:"^([a-zA-Z0-9_\\.\\-])+@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$"},this.tplType.pattern=this.pattern},render:function(e,t,i){var s=this;this.formField={},$.each(e,function(){var e=$(this).data("field"),t=s.fieldDict[e];if(t){var i=s.creatField(t);$(this).append(i),t.fieldObj=i,s.formField[e]=t}}),t&&t(this.formField),this.formObj.submit(function(){var e=s.verify();return i?i(e):e.state})},creatField:function(e){var t=e.type;if("text"==t||"password"==t||"textarea"==t||"number"==t||"phone"==t||"email"==t)i=this.tplType.text(e);else if("checkbox"==t||"radio"==t)i=this.tplType.checkbox(e);else if(this.tplType[t])i=this.tplType[t](e);else var i=$("<div>不支持此 type 类型</div>");return i},tplType:{hidden:function(e){var t='<input type="hidden" name="'+e.name+'"';return void 0!=e.value&&(t+=' value="'+e.value+'">'),$(t)},file:function(e){var t='<input type="file" name="'+e.name+'"';return void 0!=e.class&&(t+=' class="'+e.class+'"'),void 0!=e.value&&(t+=' value="'+e.value+'">'),$(t)},text:function(e){var t="";return"textarea"==e.type?t+="<textarea":("email"==e.type?t+='<input type="email"':"password"==e.type?t+='<input type="password"':t+='<input type="text"',e.maxlength?t+=' maxlength="'+e.maxlength+'"':"phone"==e.type&&(t+=' maxlength="11"'),void 0!=e.value&&(t+=' value="'+e.value+'"')),t+=' name="'+e.name+'"',void 0!=e.class&&(t+=' class="'+e.class+'"'),e.required&&(t+=" required"),e.placeholder&&(t+=' placeholder="'+e.placeholder+'"'),e.readonly&&(t+=" readonly"),e.disabled&&(t+=" disabled"),t+=">","textarea"==e.type&&(void 0!=e.value&&(t+=e.value),t+="</textarea>"),$(t)},select:function(e){var t='<select name="'+e.name+'"';void 0!=e.class&&(t+=' class="'+e.class+'"'),e.disabled&&(t+=" disabled"),t+=">";var i=e.value;return $.each(e.option,function(){t+='<option value="'+this.value+'"',i==this.value&&(t+=" selected"),t+=">"+this.text+"</option>"}),t+="</select>",$(t)},checkbox:function(e){var t="<div";void 0!=e.class&&(t+=' class="'+e.class+'"'),t+=">";var i=e.type,s=e.name,a=e.value,r=e.required,n="";return e.disabled&&(n=" disabled"),"checkbox"==i&&(a=void 0!=a?(""+a).replace(/[\s]*,[\s]*/g,","):"",a=","+a+","),$.each(e.option,function(e){t+='<label><input type="'+i+'" name="'+s+'" value="'+this.value+'"',"radio"==i?void 0!=a?a==this.value&&(t+=" checked"):r&&0==e&&(t+=" checked"):a.indexOf(","+this.value+",")>-1&&(t+=" checked"),t+=n+"> "+this.text+"</label>"}),t+="</div>",$(t)}},verify:function(){var e=this,t={state:!0,error:[],data:{}},i={},s=this.formObj.serializeArray();return $.each(s,function(){var e=$.trim(this.value);void 0==e&&(e=""),i[this.name]=e}),$.each(this.formField,function(){var s=this.type,a=i[this.name];if("text"==s||"password"==s||"textarea"==s||"number"==s||"phone"==s||"email"==s){if(this.required&&""==a)return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"required",msg:"该字段必填，请输入内容"}),!0;if(""!=a){if(("number"==s||"phone"==s||"email"==s)&&!new RegExp(e.pattern[s]).test(a)){if(t.state=!1,e.placeholder)r=e.placeholder;else r="填写的内容不符合要求，请重新填写";return t.error.push({fieldObj:this.fieldObj,code:"type",msg:r}),!0}if(this.minlength&&this.maxlength){if(a.length<this.minlength||a.length>this.maxlength)return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"length",msg:"填写的内容长度请保持在"+this.minlength+"-"+this.maxlength+"之间"}),!0}else{if(this.minlength&&a.length<this.minlength)return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"length",msg:"填写的内容长度请大于等于"+this.minlength}),!0;if(this.maxlength&&a.length>this.maxlength)return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"length",msg:"填写的内容长度请小于等于"+this.maxlength}),!0}if("number"==this.type){if(isNaN(a))return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"number",msg:"该字段只能输入数字"}),!0;if(a=+a,i[this.name]=a,void 0!=this.min&&void 0!=this.max&&this.min<this.max){if(a<this.min||a>this.max)return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"numbersize",msg:"填写的数值请在"+this.min+"-"+this.max+"之间"}),!0}else{if(void 0!=this.min&&a<this.min)return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"numbersize",msg:"填写的数值请大于等于"+this.min}),!0;if(void 0!=this.max&&a>this.max)return t.state=!1,t.error.push({fieldObj:this.fieldObj,code:"numbersize",msg:"填写的数值请小于等于"+this.max}),!0}}if(this.pattern&&!new RegExp(this.pattern).test(a)){if(t.state=!1,this.placeholder)r=this.placeholder;else var r="填写的内容不符合要求，请重新填写";return t.error.push({fieldObj:this.fieldObj,code:"pattern",msg:r}),!0}}}}),t.data=i,t},setVal:function(e){$.each(this.formField,function(){var t=this.type,i=e[this.name];void 0!=i&&("radio"==t||"checkbox"==t?("checkbox"==t&&(i=","+(""+i).replace(/[\s]*,[\s]*/g,",")+","),this.fieldObj.find("input").each(function(){"radio"==t?$(this).val()==i&&($(this)[0].checked=!0):i.indexOf(","+$(this).val()+",")>-1?$(this)[0].checked=!0:$(this)[0].checked=!1})):this.fieldObj.val(i))})},version:"2.0.3"},window.cake||(window.cake={}),window.cake.tplform=t}();